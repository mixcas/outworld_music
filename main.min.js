window.AudioContext=window.AudioContext||window.webkitAudioContext,window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,function(){"use strict";var a=[],b=0,c={sampleAudioURL:"owm.mp3",isPlayingAudio:!1,isMute:!1,levelsCount:4,volSens:.9,init:function(){this.canvas=document.getElementById("myCanvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,this.canvasRatio=this.canvas.width/this.canvas.height,this.mask=document.getElementById("mask"),this.maskRatio=this.mask.width/this.mask.height,c.animateWorld(1,0);var a=new window.AudioContext;this.analyser=a.createAnalyser(),this.analyser.smoothingTimeConstant=.8,this.analyser.fftSize=64,this.volume=a.createGain(),this.analyser.connect(this.volume),this.volume.connect(a.destination),this.binCount=this.analyser.frequencyBinCount,this.levelBins=Math.floor(this.binCount/this.levelsCount);var b=a.createBufferSource();b.connect(this.analyser);var d=new window.XMLHttpRequest;d.open("GET",this.sampleAudioURL,!0),d.responseType="arraybuffer",d.onload=function(){a.decodeAudioData(d.response,function(a){b.buffer=a,b.start(0),b.loop=!0,this.isPlayingAudio=!0,setTimeout(function(){$(".content").fadeIn(5e3)},300),$("#loading").fadeOut(500),c.render()},function(a){console.log(a)})},d.send()},clear:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},animateWorld:function(a,b){if(a="undefined"!=typeof a?a:1,b="undefined"!=typeof b?b:0,$("#bg").css("-webkit-filter")){var d=$("#bg").css("-webkit-filter").replace("hue-rotate(","").replace("deg)","");Math.abs(d-b)>25&&$("#bg").css({"-webkit-filter":"hue-rotate("+b+"deg)",filter:"hue-rotate("+b+"deg)"})}c.clear(),this.context.drawImage(this.mask,(this.canvas.width-.8*this.canvas.height*this.maskRatio*a)/2,(this.canvas.height-.8*this.canvas.height*a)/2,.8*this.canvas.height*this.maskRatio*a,.8*this.canvas.height*a)},analyse:function(){var b=new window.Uint8Array(this.binCount);this.analyser.getByteFrequencyData(b);for(var c=0;c<this.binCount;c++)a[c]=(b[c]-128)/128*this.volSens},render:function(){if(window.requestAnimationFrame(c.render),this.isPlayingAudio){c.analyse();var d=Math.abs(a[0]),e=360*a[3];this.mask&&(c.animateWorld(d,e),b=d)}},resize:function(){this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,this.canvasRatio=this.canvas.width/this.canvas.height},mute:function(){c.isMute?(c.isMute=!1,c.volume.gain.value=1,document.getElementById("mute").innerHTML="MUTE &#9785;"):(c.isMute=!0,c.volume.gain.value=0,document.getElementById("mute").innerHTML="UNMUTE &#9786;")}};window.onload=function(){c.init();var a=document.getElementById("mute");a.addEventListener("click",c.mute,!1)},window.onresize=function(){c.resize()}}();